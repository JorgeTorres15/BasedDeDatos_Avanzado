import pymysql
import pymongo

# Conexión a MySQL
mysql_conn = pymysql.connect(
    host='localhost',
    user='tu_usuario',
    password='tu_contraseña',
    database='Metacritics'
)

# Conexión a MongoDB
mongo_client = pymongo.MongoClient("mongodb://localhost:27017/")
mongodb = mongo_client["Metacritics"]

# Función para leer datos de MySQL y transformarlos en documentos para MongoDB
def migrate_table(mysql_conn, table_name):
    cursor = mysql_conn.cursor(pymysql.cursors.DictCursor)
    cursor.execute(f"SELECT * FROM {table_name}")
    rows = cursor.fetchall()

    if rows:
        # Insertar datos en la colección MongoDB correspondiente
        collection = mongodb[table_name]
        collection.insert_many(rows)

# Listado de tablas a migrar
tables_to_migrate = [
    "Plataforma",
    "Desarrollador",
    "Publicado_por",
    "Genero",
    "Clasificacion_Edad",
    "Tipo_Plataforma",
    "Videojuegos",
    "Tipo_Venta",
    "Ventas",
    "Criticas"
]

# Migración de cada tabla
for table in tables_to_migrate:
    migrate_table(mysql_conn, table)

# Cerrar conexiones
mysql_conn.close()
mongo_client.close()
